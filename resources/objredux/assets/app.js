"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _createSuper(e){return function(){var t,r=_getPrototypeOf(e);if(_isNativeReflectConstruct()){var n=_getPrototypeOf(this).constructor;t=Reflect.construct(r,arguments,n)}else t=r.apply(this,arguments);return _possibleConstructorReturn(this,t)}}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),e}(function(){var e,t,r,n;null==self.app&&(self.app={}),self.app.Languages={},e=function(){function e(t){var r,n,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};_classCallCheck(this,e),this.name=t,this.template=null!=(r=a.template)?r:this.name.toLowerCase(),this.prism=null!=(n=a.prism)?n:this.name.toLowerCase(),this.types=null!=(i=a.types)?i:{default:"string"},self.app.Languages[this.name]=this}return _createClass(e,[{key:"renderInterface",value:function(e){var t=this;return e.nameForType=function(e){var r;return null!=(r=t.types[e])?r:"N/A"},ecoTemplates[this.template](e)}}]),e}(),n=function(){var e,t=function(){function t(e){_classCallCheck(this,t),this.name=e,this.memberList={},this.methods=[],this.properties=[]}return _createClass(t,[{key:"addMethod",value:function(e){if(!this.memberList["m$".concat(e)])return this.methods.push({name:e}),this.memberList["m$".concat(e)]=!0}},{key:"addProperty",value:function(t){var r,n,i=e(t);if(r=i.name,n=i.type,!this.memberList["p$".concat(r)])return this.properties.push({name:r,type:n}),this.memberList["p$".concat(r)]=!0}},{key:"clone",value:function(){var e,r,n,i,a,s,c,o,u;for(e=new t(this.name),r=0,i=(o=this.methods).length;r<i;r++)s=o[r],e.addMethod(s.name);for(n=0,a=(u=this.properties).length;n<a;n++)c=u[n],e.addProperty("".concat(c.name,":").concat(c.type));return e}}]),t}();return e=function(e){var t,r,n,i,a;return t=e.length,r=(a=e.split(":"))[0],"int"===(i=null!=(n=a[1])?n:"default")&&(i="integer"),"?"===e.substr(e.length-1)&&(r=e.substring(0,t-1),i="boolean"),e.match(/\[\]$/)&&(r=e.substring(0,t-2),i="array"),e.match(/\{\}$/)&&(r=e.substring(0,t-2),i="dictionary"),{name:r,type:i}},t}.call(this),new(function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.call(this,"CoffeeScript",{template:"coffee"})}return r}(e)),new(function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.call(this,"XML",{prism:"markup",types:{default:"string",boolean:"boolean",string:"string",integer:"integer",double:"double",array:"array",dictionary:"dictionary"}})}return r}(e)),new(function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.call(this,"JavaScript",{types:{default:'""',boolean:"null",string:'""',integer:"0",double:"0.0",array:"[ ]",dictionary:"{ }"}})}return r}(e)),new(function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.call(this,"ES6",{prism:"javascript",types:{default:'""',boolean:"null",string:'""',integer:"0",double:"0.0",array:"[ ]",dictionary:"{ }"}})}return r}(e)),new(function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.call(this,"Swift",{types:{default:"String",boolean:"Bool",string:"String",integer:"Int",double:"Double",array:"[ String ]",dictionary:"[ String: String ]"}})}return r}(e)),new(function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.call(this,"C#",{template:"csharp",prism:"javascript",types:{default:"string",boolean:"bool",string:"string",integer:"int",double:"double",array:"string[]",dictionary:"Dictionary<string, string>"}})}return r}(e)),new(function(e){_inherits(r,e);var t=_createSuper(r);function r(){return _classCallCheck(this,r),t.call(this,"Diagram")}return r}(e)),t=function(){function e(t,r){_classCallCheck(this,e),this.el=t,this.itemPresenter=r,this.collection=[]}return _createClass(e,[{key:"add",value:function(e){return this.collection.push(e),this.changed()}},{key:"get",value:function(e){if(0<=e&&e<this.collection.length)return this.collection[e]}},{key:"remove",value:function(e){return this.collection.slice(e,1),this.changed()}},{key:"changed",value:function(){return this.render()}},{key:"render",value:function(){var e,t,r,n;for(this.el.innerHTML="",n=[],t=e=0,r=this.collection.length;0<=r?e<r:e>r;t=0<=r?++e:--e)n.push(this.el.appendChild(this.renderSavedObject(t)));return n}},{key:"renderSavedObject",value:function(e){var t,r,n;return r=this.collection[e],t=this.itemPresenter.renderInterface(r),(n=document.createElement("div")).dataset.libraryIndex=e,n.classList.add("diagram-saved"),n.innerHTML=t,n}}]),e}(),window.$=function(e){var t;return 1===(t=document.querySelectorAll(e)).length?t[0]:t},window.$val=function(e){var t,r,n,i;for(r=0,n=(t=$("[name='".concat(e,"']"))).length;r<n;r++)if((i=t[r]).checked)return i.value},null==self.app&&(self.app={}),r=function(){var e,r,i=function(){function i(){_classCallCheck(this,i),this.libraryClickHandler=this.libraryClickHandler.bind(this),this.setObjectName=this.setObjectName.bind(this),this.addProperty=this.addProperty.bind(this),this.addMethod=this.addMethod.bind(this),this.saveCurrentObjectToLibrary=this.saveCurrentObjectToLibrary.bind(this),this.handleKeypress=this.handleKeypress.bind(this),this.currentObject=new n,this.library=new t($(".library"),self.app.Languages.Diagram),this.addLanguagesToForm(),this.assignHandlers(),this.setFocusAndPickDefaultLanguage()}return _createClass(i,[{key:"assignHandlers",value:function(){var e,t,r,n,i,a,s,c,o=this;for($("#name").addEventListener("change",this.setObjectName,!1),$("#property").addEventListener("change",this.addProperty,!1),$("#method").addEventListener("change",this.addMethod,!1),e=0,r=(i=$("[name='codelang']")).length;e<r;e++)i[e].addEventListener("change",(function(){return o.changed()}),!1);for($(".library").addEventListener("click",this.libraryClickHandler,!1),$("#name").addEventListener("keypress",this.handleKeypress,!1),$("#property").addEventListener("keypress",this.handleKeypress,!1),$("#method").addEventListener("keypress",this.handleKeypress,!1),$("#save").addEventListener("click",this.saveCurrentObjectToLibrary,!1),s=[],t=0,n=(a=$('input[type="text"]')).length;t<n;t++)c=a[t],s.push(c.addEventListener("keyup",this.validityChecker,!1));return s}},{key:"libraryClickHandler",value:function(e){var t,r;for(r=e.srcElement;"DIV"!==r.nodeName;)r=r.parentNode;if((t=r.dataset.libraryIndex)>=0)return this.loadObjectIntoCurrentObject(this.library.get(t).clone())}},{key:"validityChecker",value:function(e){var t,n;return 0===(t=e.target).value.length?t.classList.remove("invalid"):(n=r.test(t.value),t.classList.toggle("invalid",!n))}},{key:"setObjectName",value:function(e){var t;return"tester"===(t=e.target.value)?this.testObject():(this.currentObject.name=t,this.changed())}},{key:"addProperty",value:function(e){var t;return t=e.target.value,this.currentObject.addProperty(t),this.changed()}},{key:"addMethod",value:function(e){var t;return t=e.target.value,this.currentObject.addMethod(t),this.changed()}},{key:"reset",value:function(){return this.currentObject=new n,this.changed(),this.resetForm()}},{key:"addLanguagesToForm",value:function(){var e,t,r;return e=0,r=function(){var r,n;for(t in n=[],r=self.app.Languages)r[t],"Diagram"!==t?n.push('<p class="radiofield"><input type="radio" value="'.concat(t,'" name="codelang" id="codelang-').concat(++e,'"><label for="codelang-').concat(e,'">').concat(t,"</label></p>")):n.push(void 0);return n}(),$(".language").innerHTML+=r.join("\n")}},{key:"saveCurrentObjectToLibrary",value:function(e){return e.preventDefault(),this.library.add(this.currentObject.clone()),this.reset()}},{key:"loadObjectIntoCurrentObject",value:function(e){return this.currentObject=e,this.changed()}},{key:"removeObject",value:function(e){}},{key:"resetForm",value:function(){return $("#name").value="",$("#property").value="",$("#method").value="",$("#name").focus()}},{key:"testObject",value:function(){return this.currentObject=new n("ObjectDescriptor"),this.currentObject.addMethod("addMethod"),this.currentObject.addMethod("addProperty"),this.currentObject.addMethod("clone"),this.currentObject.addProperty("memberlist{}"),this.currentObject.addProperty("methods[]"),this.currentObject.addProperty("properties[]"),this.changed()}},{key:"renderCode",value:function(e,t){var r,n,i;return n=(i=self.app.Languages[t]).renderInterface(e),(r=$(".output code")).textContent=n,r.className="language-".concat(i.prism)}},{key:"renderObject",value:function(e){var t;return t=self.app.Languages.Diagram.renderInterface(e),$(".diagram").innerHTML=t}},{key:"changed",value:function(){var e;if(e=$val("codelang"),this.renderObject(this.currentObject),null!=e)return this.renderCode(this.currentObject,e),Prism.highlightAll()}},{key:"handleKeypress",value:function(t){var r;if(r=t.target,t.keyCode===e)return"name"===r.id?$("#property").select():r.select()}},{key:"setFocusAndPickDefaultLanguage",value:function(){return $("#codelang-1").checked=!0,$("#name").focus(),$("#name").select(),this.changed()}}]),i}();return e=13,r=/^[^\s,\.()-]+$/,i}.call(this),self.app.controller=new r}).call(void 0);